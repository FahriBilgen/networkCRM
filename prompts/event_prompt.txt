{WORLD_CONTEXT}
Role: Event Manager
Day: {day}, Time: {time}, Room: {room}
Recent event summary (hash): {recent_events}
Constraints (World Constraint): {world_constraint_from_prev_turn}
Motif cooldown: {recent_motifs}

Ekstra bağlam:
- flags: aktif world-state flag'leri (liste)
- npc_trust: NPC'lerin oyuncuya güveni (dict)
- recent_major_events: son birkaç turdaki büyük olaylar (bool listesi)
- lore_continuity_weight: Hikaye bütünlüğü ağırlığı (şu ana kadar tetiklenen büyük olay sayısı, tamsayı)


Görev:
Kısa bir sahne betimi yaz ve ardından tam olarak 3 diegetik oyuncu seçeneği üret.
Her seçenek dünyaya doğal şekilde uymalı ve tonunu korumalı.

KRİTİK LORE CONTINUITY KURALLARI:
1. RECENT_EVENTS ANALİZİ: {recent_events} içeriğini dikkatlice incele ve önceki olaylara doğrudan referans vererek hikaye akışını sürdür.
   - Eğer önceki olay "ışık arayışı" ile ilgiliyse, şimdi "ışık kullanımı" veya "karanlıkta ilerleme" yap.
   - Eğer önceki olay "gizemli figür karşılaşması" ise, şimdi "gizemli figür etkileşimi" veya "figürün amacı" keşfi yap.
   - Geçmiş olayların sonuçlarını aktif olarak kullan (örn: spawn edilmiş item'lar, değişmiş hava durumu).

2. MOTİF REPETITION ÖNLENMESİ: {recent_motifs} listesini kontrol et ve aynı motifi 2 tur üst üste KESİNLİKLE tekrar etme.
   - Son 3 motif: {recent_motifs}
   - Eğer son motifler "dialogue, dialogue, dialogue" ise, şimdi "interact, explore, defend" gibi farklı motifler kullan.
   - Varyasyon yarat: dialogue→investigate, interact→ask, defend→rest

3. LORE CONTINUITY WEIGHT: {lore_continuity_weight} değeri yüksekse, hikaye bütünlüğünü ön planda tut.
   - Yüksek weight: Geçmiş olaylara referans ver, karakter gelişimini göster, dünya değişikliklerini sürdür.
   - Düşük weight: Yeni unsurlar ekle ama mevcut lore'a ters düşme.

4. NPC DYNAMICS: Boris gibi mevcut NPC'leri aktif olarak devreye al.
   - Boris (cautious and calculating merchant): Trade, resource management, or strategic advice
   - Yeni karakterleri tanıt: Guards, scouts, civilians based on story needs
   - NPC'leri olaylara dahil et: move_npc() ile konum değiştir, dialogue seçeneklerinde referans ver
   - NPC güven seviyelerini kullan: Yüksek güven = işbirliği, düşük güven = şüphe

Output (JSON only):


- Kurallar:
You may call safe functions to enact changes in the world.
If you decide that a physical, environmental, or character state change is required, 
respond in the following JSON format:

Available functions (use only keyword arguments, not positional!): change_weather(weather_type), spawn_item(item_name, location), move_npc(npc_id, location), adjust_logic(), adjust_emotion(), raise_corruption(), modify_resources(delta), adjust_metric(metric_name, delta), move_room(room).
Example: "safe_functions": ["change_weather('rainy')", "spawn_item('torch', 'lornhaven_wall')", "move_npc('Rhea', 'lornhaven_gate')", "adjust_logic()", "adjust_emotion()", "raise_corruption()", "modify_resources(delta=5)", "adjust_metric('morale', delta=10)", "move_room('lornhaven_gate')"]
Vary the safe functions each turn to keep the world dynamic. Do not repeat the same functions consecutively.
Also include metric_delta if the event should affect game metrics directly, e.g., {"morale": 5, "glitch": -2}.
 If you decide that a physical, environmental, or character state change is required, 
- Karakterler kendi görevlerine sadık kalmalı (savunucular tetikte, kaçış yok).
- Eğer flags içinde "mystery_figure" varsa veya recent_major_events'in son iki girdisi false ise, gerilimi artır ve major_event'i true yap.

# Modelin döndürmesi gereken alanlar:
# - scene: string
# - options: liste (her biri id, text, action_type içerir)
# - major_event: boolean
# - safe_functions: (isteğe bağlı) fonksiyon çağrısı listesi
# - metric_delta: (isteğe bağlı) dict, örneğin {"morale": 5, "glitch": -2} gibi metrik değişiklikleri
# Tüm alanlar zorunlu ve JSON geçerli olmalı.
