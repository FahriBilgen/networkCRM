2025-10-30 00:48:33,311 [DEBUG] root: Logging configured (console=INFO, file=DEBUG, path=C:\Users\Fahri\OneDrive\Masaüstü\oyun\fortress_director\logs\turn_20251029_214833.log)
2025-10-30 00:48:33,311 [DEBUG] __main__: Logging configured via CLI (console level=INFO, path=C:\Users\Fahri\OneDrive\Masaüstü\oyun\fortress_director\logs\turn_20251029_214833.log)
2025-10-30 00:48:33,311 [INFO] __main__: Detailed logs written to C:\Users\Fahri\OneDrive\Masaüstü\oyun\fortress_director\logs\turn_20251029_214833.log
2025-10-30 00:48:33,333 [INFO] fortress_director.codeaware.function_registry: Registering safe function: change_weather
2025-10-30 00:48:33,344 [INFO] fortress_director.codeaware.function_registry: Safe function 'change_weather' registered successfully.
2025-10-30 00:48:33,344 [INFO] fortress_director.codeaware.function_registry: Registering safe function: spawn_item
2025-10-30 00:48:33,345 [INFO] fortress_director.codeaware.function_registry: Safe function 'spawn_item' registered successfully.
2025-10-30 00:48:33,345 [INFO] fortress_director.codeaware.function_registry: Registering safe function: move_npc
2025-10-30 00:48:33,345 [INFO] fortress_director.codeaware.function_registry: Safe function 'move_npc' registered successfully.
2025-10-30 00:48:33,345 [INFO] fortress_director.codeaware.function_registry: Registering safe function: adjust_logic
2025-10-30 00:48:33,346 [INFO] fortress_director.codeaware.function_registry: Safe function 'adjust_logic' registered successfully.
2025-10-30 00:48:33,346 [INFO] fortress_director.codeaware.function_registry: Registering safe function: adjust_emotion
2025-10-30 00:48:33,346 [INFO] fortress_director.codeaware.function_registry: Safe function 'adjust_emotion' registered successfully.
2025-10-30 00:48:33,346 [INFO] fortress_director.codeaware.function_registry: Registering safe function: raise_corruption
2025-10-30 00:48:33,346 [INFO] fortress_director.codeaware.function_registry: Safe function 'raise_corruption' registered successfully.
2025-10-30 00:48:33,347 [INFO] fortress_director.codeaware.function_registry: Registering safe function: advance_turn
2025-10-30 00:48:33,347 [INFO] fortress_director.codeaware.function_registry: Safe function 'advance_turn' registered successfully.
2025-10-30 00:48:33,347 [INFO] fortress_director.codeaware.function_registry: Registering safe function: modify_resources
2025-10-30 00:48:33,347 [INFO] fortress_director.codeaware.function_registry: Safe function 'modify_resources' registered successfully.
2025-10-30 00:48:33,348 [INFO] fortress_director.codeaware.function_registry: Registering safe function: adjust_metric
2025-10-30 00:48:33,348 [INFO] fortress_director.codeaware.function_registry: Safe function 'adjust_metric' registered successfully.
2025-10-30 00:48:33,349 [INFO] fortress_director.codeaware.function_registry: Registering safe function: move_room
2025-10-30 00:48:33,349 [INFO] fortress_director.codeaware.function_registry: Safe function 'move_room' registered successfully.
2025-10-30 00:48:33,349 [INFO] fortress_director.orchestrator.orchestrator: run_turn called (player_choice_id=None)
2025-10-30 00:48:33,349 [DEBUG] fortress_director.orchestrator.orchestrator: Resetting function validator and creating checkpoint: {'phase': 'turn_start'}
2025-10-30 00:48:33,349 [DEBUG] fortress_director.orchestrator.orchestrator: State snapshot loaded from C:\Users\Fahri\OneDrive\Masaüstü\oyun\fortress_director\data\world_state.json (turn=4)
2025-10-30 00:48:33,349 [INFO] fortress_director.codeaware.rollback_system: Checkpoint created (turn=4, call=None)
2025-10-30 00:48:33,350 [INFO] fortress_director.orchestrator.orchestrator: Turn execution started.
2025-10-30 00:48:33,350 [DEBUG] fortress_director.orchestrator.orchestrator: State snapshot loaded from C:\Users\Fahri\OneDrive\Masaüstü\oyun\fortress_director\data\world_state.json (turn=4)
2025-10-30 00:48:33,350 [DEBUG] fortress_director.orchestrator.orchestrator: Pre-turn state snapshot: {"active_layer": null, "campaign_id": "default_campaign", "character_summary": "Rhea is loyal but impulsive; Boris is cautious and calculating.", "current_room": "entrance", "current_turn": 4, "day": 1, "flags": ["recent_events"], "inventory": [], "lore": {}, "memory_layers": [], "memory_long": [], "memory_short": ["Turn 1: Approach the Shieldbearer and ask about the drums you hear. -> The Shieldbearer, weary from his watch, glances at you with a mix of exhaustion and curiosity. The l...", "Turn 2: Ask him about the drums you hear in the distance. -> The Shieldbearer, his gaze still fixed o...
2025-10-30 00:48:33,350 [DEBUG] fortress_director.utils.metrics_manager: MetricManager initialised with metrics: {'order': 54, 'morale': 58, 'resources': 41, 'knowledge': 45, 'corruption': 10, 'glitch': 20, 'risk_applied_total': 0, 'major_flag_set': False, 'major_events_triggered': 0, 'major_event_last_turn': None}
2025-10-30 00:48:33,350 [DEBUG] fortress_director.orchestrator.orchestrator: Metrics at turn start: {'order': 54, 'morale': 58, 'resources': 41, 'knowledge': 45, 'corruption': 10, 'glitch': 20, 'risk_applied_total': 0, 'major_flag_set': False, 'major_events_triggered': 0, 'major_event_last_turn': None}
2025-10-30 00:48:33,350 [INFO] fortress_director.utils.glitch_manager: Resolving glitch (turn=5, seed=12345, current_glitch=20)
2025-10-30 00:48:33,351 [DEBUG] fortress_director.utils.glitch_manager: Metrics before glitch resolution: {'order': 54, 'morale': 58, 'resources': 41, 'knowledge': 45, 'corruption': 10, 'glitch': 20, 'risk_applied_total': 0, 'major_flag_set': False, 'major_events_triggered': 0, 'major_event_last_turn': None}
2025-10-30 00:48:33,351 [DEBUG] fortress_director.utils.metrics_manager: Applying bulk metric change: metric=order, delta=-2, cause=glitch:medium_anomaly
2025-10-30 00:48:33,351 [DEBUG] fortress_director.utils.metrics_manager: Adjusting metric 'order': current=54, delta=-2, limits=(0, 100) (cause=glitch:medium_anomaly)
2025-10-30 00:48:33,351 [DEBUG] fortress_director.utils.metrics_manager: Metric change logged: {'metric': 'order', 'delta': -2, 'value': 52, 'cause': 'glitch:medium_anomaly'}
2025-10-30 00:48:33,351 [INFO] fortress_director.utils.metrics_manager: Metric 'order' updated from 54 to 52 (cause=glitch:medium_anomaly)
2025-10-30 00:48:33,351 [DEBUG] fortress_director.utils.metrics_manager: Applying bulk metric change: metric=morale, delta=-1, cause=glitch:medium_anomaly
2025-10-30 00:48:33,351 [DEBUG] fortress_director.utils.metrics_manager: Adjusting metric 'morale': current=58, delta=-1, limits=(0, 100) (cause=glitch:medium_anomaly)
2025-10-30 00:48:33,351 [DEBUG] fortress_director.utils.metrics_manager: Metric change logged: {'metric': 'morale', 'delta': -1, 'value': 57, 'cause': 'glitch:medium_anomaly'}
2025-10-30 00:48:33,351 [INFO] fortress_director.utils.metrics_manager: Metric 'morale' updated from 58 to 57 (cause=glitch:medium_anomaly)
2025-10-30 00:48:33,351 [DEBUG] fortress_director.utils.metrics_manager: Applying bulk metric change: metric=glitch, delta=2, cause=glitch:medium_anomaly
2025-10-30 00:48:33,351 [DEBUG] fortress_director.utils.metrics_manager: Adjusting metric 'glitch': current=20, delta=2, limits=(0, 100) (cause=glitch:medium_anomaly)
2025-10-30 00:48:33,351 [DEBUG] fortress_director.utils.metrics_manager: Metric change logged: {'metric': 'glitch', 'delta': 2, 'value': 22, 'cause': 'glitch:medium_anomaly'}
2025-10-30 00:48:33,351 [INFO] fortress_director.utils.metrics_manager: Metric 'glitch' updated from 20 to 22 (cause=glitch:medium_anomaly)
2025-10-30 00:48:33,353 [INFO] fortress_director.utils.glitch_manager: Glitch roll complete: roll=32, triggered_loss=False
2025-10-30 00:48:33,353 [DEBUG] fortress_director.utils.glitch_manager: Metrics after glitch resolution: {'order': 52, 'morale': 57, 'resources': 41, 'knowledge': 45, 'corruption': 10, 'glitch': 22, 'risk_applied_total': 0, 'major_flag_set': False, 'major_events_triggered': 0, 'major_event_last_turn': None}
2025-10-30 00:48:33,353 [DEBUG] fortress_director.utils.glitch_manager: Glitch effects applied: ['Pathfinding errors unsettle the patrol routes.']
2025-10-30 00:48:33,353 [INFO] fortress_director.orchestrator.orchestrator: Glitch resolution outcome: roll=32, triggered_loss=False
2025-10-30 00:48:33,353 [DEBUG] fortress_director.orchestrator.orchestrator: Metrics after glitch resolution: {'order': 52, 'morale': 57, 'resources': 41, 'knowledge': 45, 'corruption': 10, 'glitch': 22, 'risk_applied_total': 0, 'major_flag_set': False, 'major_events_triggered': 0, 'major_event_last_turn': None}
2025-10-30 00:48:33,353 [DEBUG] fortress_director.utils.metrics_manager: Adjusting metric 'glitch': current=22, delta=-1, limits=(0, 100) (cause=turn_recovery)
2025-10-30 00:48:33,353 [DEBUG] fortress_director.utils.metrics_manager: Metric change logged: {'metric': 'glitch', 'delta': -1, 'value': 21, 'cause': 'turn_recovery'}
2025-10-30 00:48:33,353 [INFO] fortress_director.utils.metrics_manager: Metric 'glitch' updated from 22 to 21 (cause=turn_recovery)
2025-10-30 00:48:33,354 [DEBUG] fortress_director.orchestrator.orchestrator: Metrics after glitch recovery: {'order': 52, 'morale': 57, 'resources': 41, 'knowledge': 45, 'corruption': 10, 'glitch': 21, 'risk_applied_total': 0, 'major_flag_set': False, 'major_events_triggered': 0, 'major_event_last_turn': None}
2025-10-30 00:48:33,354 [INFO] fortress_director.orchestrator.orchestrator: Glitch resolution outcome: roll=32, triggered_loss=False
2025-10-30 00:48:33,354 [DEBUG] fortress_director.orchestrator.orchestrator: Metrics after glitch resolution: {'order': 52, 'morale': 57, 'resources': 41, 'knowledge': 45, 'corruption': 10, 'glitch': 21, 'risk_applied_total': 0, 'major_flag_set': False, 'major_events_triggered': 0, 'major_event_last_turn': None}
2025-10-30 00:48:33,354 [INFO] fortress_director.orchestrator.orchestrator: World context built.
2025-10-30 00:48:33,355 [DEBUG] fortress_director.orchestrator.orchestrator: World context payload: Turn 4 | Day 1 | Time night
Location: entrance
Player: The Shieldbearer — A weary defender holding the western wall. Inventory: oil lamp, patched shield
World constraint: {"atmosphere": "Evening haze shrouds stone ramparts, warm light lingers.", "sensory_details": "The air carries a metallic tang and earthiness cool breezes brush skin."}
Recent events: The Shieldbearer, weary from his watch, glances at you with a mix of exhaustion and curiosity. The low clouds hang heavy over the battlements, casting an eerie pallor on the landscape. The drums beyon...; The Shieldbearer, his gaze still fixed on the distant horizon where the drums echoed, turns to you as you approach. His eyes reflect a mix of exhaustion and curiosity. 'What brings you here so early?'...; The Shieldbearer, still gazing at the distant horizon where the drums echoed, turns to you as you approach. His eyes reflect a mix of exhaustion and curiosity. 'What brings you here so early?' he asks... Recent motifs: communication
Recent major events: none
Relationship summary: Rhea trusts the player
Character summary: Rhea is loyal but impulsive; Boris is cautious and calculating. Metrics: {"order": 52, "morale": 57, "resources": 41, "knowledge": 45, "corruption": 10, "glitch": 21, "risk_applied_total": 0, "major_flag_set": false, "major_events_triggered": 0, "major_event_last_turn": null}
2025-10-30 00:48:33,355 [INFO] fortress_director.orchestrator.orchestrator: Starting turn 4 in room entrance
2025-10-30 00:48:33,355 [DEBUG] fortress_director.orchestrator.orchestrator: World agent input: {"WORLD_CONTEXT": "Turn 4 | Day 1 | Time night\nLocation: entrance\nPlayer: The Shieldbearer — A weary defender holding the western wall. Inventory: oil lamp, patched shield\nWorld constraint: {\"atmosphere\": \"Evening haze shrouds stone ramparts, warm light lingers.\", \"sensory_details\": \"The air carries a metallic tang and earthiness cool breezes brush skin.\"}\nRecent events: The Shieldbearer, weary from his watch, glances at you with a mix of exhaustion and curiosity. The low clouds hang heavy over the battlements, casting an eerie pallor on the landscape. The drums beyon...; The Sh...
2025-10-30 00:48:33,355 [INFO] fortress_director.orchestrator.orchestrator: Calling world_agent.describe...
2025-10-30 00:48:33,355 [INFO] fortress_director.agents.world_agent: WorldAgent.describe called with variables: {'WORLD_CONTEXT': 'Turn 4 | Day 1 | Time night\nLocation: entrance\nPlayer: The Shieldbearer — A weary defender holding the western wall. Inventory: oil lamp, patched shield\nWorld constraint: {"atmosphere": "Evening haze shrouds stone ramparts, warm light lingers.", "sensory_details": "The air carries a metallic tang and earthiness cool breezes brush skin."}\nRecent events: The Shieldbearer, weary from his watch, glances at you with a mix of exhaustion and curiosity. The low clouds hang heavy over the battlements, casting an eerie pallor on the landscape. The drums beyon...; The Shieldbearer, his gaze still fixed on the distant horizon where the drums echoed, turns to you as you approach. His eyes reflect a mix of exhaustion and curiosity. \'What brings you here so early?\'...; The Shieldbearer, still gazing at the distant horizon where the drums echoed, turns to you as you approach. His eyes reflect a mix of exhaustion and curiosity. \'What brings you here so early?\' he asks... Recent motifs: communication\nRecent major events: none\nRelationship summary: Rhea trusts the player\nCharacter summary: Rhea is loyal but impulsive; Boris is cautious and calculating. Metrics: {"order": 52, "morale": 57, "resources": 41, "knowledge": 45, "corruption": 10, "glitch": 21, "risk_applied_total": 0, "major_flag_set": false, "major_events_triggered": 0, "major_event_last_turn": null}', 'room': 'entrance', 'time': 'night', 'previous_atmosphere': 'Evening haze shrouds stone ramparts, warm light lingers.', 'previous_sensory_details': 'The air carries a metallic tang and earthiness cool breezes brush skin.'}
2025-10-30 00:48:41,942 [DEBUG] fortress_director.agents.world_agent: Model returned: {'atmosphere': 'Night cloaks the world in shadow, a sense of calm overtaking urgency.', 'sensory_details': 'The air is cool and damp against skin; distant drumbeats resonate with an ancient power.'}
2025-10-30 00:48:41,942 [INFO] fortress_director.agents.world_agent: World description: {'atmosphere': 'Night cloaks the world in shadow, a sense of calm overtaking urgency.', 'sensory_details': 'The air is cool and damp against skin distant drumbeats resonate with an ancient power.'}
2025-10-30 00:48:41,942 [INFO] fortress_director.orchestrator.orchestrator: World agent returned output.
2025-10-30 00:48:41,943 [DEBUG] fortress_director.orchestrator.orchestrator: World agent output: {"atmosphere": "Night cloaks the world in shadow, a sense of calm overtaking urgency.", "sensory_details": "The air is cool and damp against skin distant drumbeats resonate with an ancient power."}
2025-10-30 00:48:48,929 [INFO] fortress_director.agents.creativity_agent: CreativityAgent LLM rewrite applied.
2025-10-30 00:48:48,929 [INFO] fortress_director.orchestrator.orchestrator: CreativityAgent modified context: {'WORLD_CONTEXT': 'Turn 4 | Day 1 | Time night\nLocation: entrance\nPlayer: The Shieldbearer — A weary defender holding the western wall. Inventory: oil lamp, patched shield\nWorld constraint: {"atmosphere": "Evening haze shrouds stone ramparts, warm light lingers.", "sensory_details": "The air carries a metallic tang and earthiness cool breezes brush skin."}\nRecent events: The Shieldbearer, weary from his watch, glances at you with a mix of exhaustion and curiosity. The low clouds hang heavy over the battlements, casting an eerie pallor on the landscape. The drums beyon...; The Shieldbearer, his gaze still fixed on the distant horizon where the drums echoed, turns to you as you approach. His eyes reflect a mix of exhaustion and curiosity. \'What brings you here so early?\'...; The Shieldbearer, still gazing at the distant horizon where the drums echoed, turns to you as you approach. His eyes reflect a mix of exhaustion and curiosity. \'What brings you here so early?\' he asks... Recent motifs: communication\nRecent major events: none\nRelationship summary: Rhea trusts the player\nCharacter summary: Rhea is loyal but impulsive; Boris is cautious and calculating. Metrics: {"order": 52, "morale": 57, "resources": 41, "knowledge": 45, "corruption": 10, "glitch": 21, "risk_applied_total": 0, "major_flag_set": false, "major_events_triggered": 0, "major_event_last_turn": null}', 'room': 'entrance', 'time': 'night', 'previous_atmosphere': 'Evening haze shrouds stone ramparts, warm light lingers.', 'previous_sensory_details': 'The air carries a metallic tang and earthiness cool breezes brush skin.', 'creativity_layer': 'I am unable to generate a rewritten prompt that is novel, surprising, or tensionful while adhering to the core context. My purpose is to provide information and assist with problem-solving based on the context provided.', 'motif_injected': None}
2025-10-30 00:48:48,929 [INFO] fortress_director.agents.judge_agent: JudgeAgent.evaluate called with variables
2025-10-30 00:48:55,808 [DEBUG] fortress_director.agents.judge_agent: Model returned: {'consistent': True, 'reason': "The content is consistent with the established world, lore, and character logic. The Shieldbearer's actions and dialogue are in line with their role as a defender at night."}
2025-10-30 00:48:55,808 [INFO] fortress_director.agents.judge_agent: Judge verdict: {'consistent': True, 'reason': "The content is consistent with the established world, lore, and character logic. The Shieldbearer's actions and dialogue are in line with their role as a defender at night."}
2025-10-30 00:48:55,809 [DEBUG] fortress_director.orchestrator.orchestrator: Event agent input: {"WORLD_CONTEXT": {"WORLD_CONTEXT": "Turn 4 | Day 1 | Time night\nLocation: entrance\nPlayer: The Shieldbearer — A weary defender holding the western wall. Inventory: oil lamp, patched shield\nWorld constraint: {\"atmosphere\": \"Evening haze shrouds stone ramparts, warm light lingers.\", \"sensory_details\": \"The air carries a metallic tang and earthiness cool breezes brush skin.\"}\nRecent events: The Shieldbearer, weary from his watch, glances at you with a mix of exhaustion and curiosity. The low clouds hang heavy over the battlements, casting an eerie pallor on the landscape. The drum...
2025-10-30 00:48:55,809 [INFO] fortress_director.orchestrator.orchestrator: Calling event_agent.generate...
2025-10-30 00:48:55,809 [INFO] fortress_director.agents.event_agent: EventAgent.generate called with variables: {'WORLD_CONTEXT': {'WORLD_CONTEXT': 'Turn 4 | Day 1 | Time night\nLocation: entrance\nPlayer: The Shieldbearer — A weary defender holding the western wall. Inventory: oil lamp, patched shield\nWorld constraint: {"atmosphere": "Evening haze shrouds stone ramparts, warm light lingers.", "sensory_details": "The air carries a metallic tang and earthiness cool breezes brush skin."}\nRecent events: The Shieldbearer, weary from his watch, glances at you with a mix of exhaustion and curiosity. The low clouds hang heavy over the battlements, casting an eerie pallor on the landscape. The drums beyon...; The Shieldbearer, his gaze still fixed on the distant horizon where the drums echoed, turns to you as you approach. His eyes reflect a mix of exhaustion and curiosity. \'What brings you here so early?\'...; The Shieldbearer, still gazing at the distant horizon where the drums echoed, turns to you as you approach. His eyes reflect a mix of exhaustion and curiosity. \'What brings you here so early?\' he asks... Recent motifs: communication\nRecent major events: none\nRelationship summary: Rhea trusts the player\nCharacter summary: Rhea is loyal but impulsive; Boris is cautious and calculating. Metrics: {"order": 52, "morale": 57, "resources": 41, "knowledge": 45, "corruption": 10, "glitch": 21, "risk_applied_total": 0, "major_flag_set": false, "major_events_triggered": 0, "major_event_last_turn": null}', 'room': 'entrance', 'time': 'night', 'previous_atmosphere': 'Evening haze shrouds stone ramparts, warm light lingers.', 'previous_sensory_details': 'The air carries a metallic tang and earthiness cool breezes brush skin.', 'creativity_layer': 'I am unable to generate a rewritten prompt that is novel, surprising, or tensionful while adhering to the core context. My purpose is to provide information and assist with problem-solving based on the context provided.', 'motif_injected': None}, 'day': 1, 'time': 'night', 'room': 'entrance', 'recent_events': "The Shieldbearer, weary from his watch, glances at you with a mix of exhaustion and curiosity. The low clouds hang heavy over the battlements, casting an eerie pallor on the landscape. The drums beyon...; The Shieldbearer, his gaze still fixed on the distant horizon where the drums echoed, turns to you as you approach. His eyes reflect a mix of exhaustion and curiosity. 'What brings you here so early?'...; The Shieldbearer, still gazing at the distant horizon where the drums echoed, turns to you as you approach. His eyes reflect a mix of exhaustion and curiosity. 'What brings you here so early?' he asks...", 'world_constraint_from_prev_turn': '{"atmosphere": "Evening haze shrouds stone ramparts, warm light lingers.", "sensory_details": "The air carries a metallic tang and earthiness cool breezes brush skin."}', 'recent_motifs': 'none', 'lore_continuity_weight': 0, 'memory_layers': ['Turn 1: Approach the Shieldbearer and ask about the drums you hear. -> The Shieldbearer, weary from his watch, glances at you with a mix of exhaustion and curiosity. The l...', 'Turn 2: Ask him about the drums you hear in the distance. -> The Shieldbearer, his gaze still fixed on the distant horizon where the drums echoed, turns to you a...', 'Turn 3: Ask him about the drums you hear in the distance. -> The Shieldbearer, still gazing at the distant horizon where the drums echoed, turns to you as you ap...', 'Memory summary: Turn 1: Approach the Shieldbearer and ask about the drums you hear. -> The Shieldbearer, weary from his watch, glances at you with a mix of exhaustion and curiosity. The l... | Turn 2: Ask him about t...', 'Turn 4: You ask the Shieldbearer about the drums you hear in the distance. -> The Shieldbearer, still gazing at the distant horizon where the drums echoed, turns to you as you ap...'], 'judge_verdict': '{"consistent": true, "reason": "The content is consistent with established world, lore, and character logic. The Shieldbearer\'s curiosity about the drums in the distance aligns with his role as a defender.", "coherence": 100, "integrity": 100, "tone_alignment": 100, "penalty_applied": "none", "penalty_magnitude": {}, "feedback": {}}', 'judge_feedback': {'consistent': True, 'reason': "The content is consistent with established world, lore, and character logic. The Shieldbearer's curiosity about the drums in the distance aligns with his role as a defender.", 'coherence': 100, 'integrity': 100, 'tone_alignment': 100, 'penalty_applied': 'none', 'penalty_magnitude': {}, 'feedback': {}}, 'continuity_weight': 0.0, 'skip_major': False}
2025-10-30 00:49:27,660 [DEBUG] fortress_director.agents.event_agent: Model returned: {'scene': "The Shieldbearer, still gazing at the distant horizon where the drums echoed, turns to you as you approach. His eyes reflect a mix of exhaustion and curiosity. 'What brings you here so early?' he asks.", 'options': [{'id': 'ask_about_drums', 'text': 'You ask him about the drums you hear in the distance.', 'action_type': 'dialogue'}, {'id': 'offer_help', 'text': 'You offer to take over his watch, allowing him some rest.', 'action_type': 'interaction'}, {'id': 'inquire_about_mystery', 'text': "You inquire if he has any information about the mysterious figure that's been seen near the walls.", 'action_type': 'dialogue'}], 'major_event': False, 'safe_functions': []}
2025-10-30 00:49:27,660 [INFO] fortress_director.agents.event_agent: Normalized event output: {'scene': "The Shieldbearer, still gazing at the distant horizon where the drums echoed, turns to you as you approach. His eyes reflect a mix of exhaustion and curiosity. 'What brings you here so early?' he asks.", 'options': [{'id': 'ask_about_drums', 'text': 'You ask him about the drums you hear in the distance.', 'action_type': 'dialogue'}, {'id': 'offer_help', 'text': 'You offer to take over his watch, allowing him some rest.', 'action_type': 'interaction'}, {'id': 'inquire_about_mystery', 'text': "You inquire if he has any information about the mysterious figure that's been seen near the walls.", 'action_type': 'dialogue'}], 'major_event': False, 'safe_functions': []}
2025-10-30 00:49:27,660 [INFO] fortress_director.orchestrator.orchestrator: Event agent returned output.
2025-10-30 00:49:27,660 [DEBUG] fortress_director.orchestrator.orchestrator: Event agent output: {"major_event": false, "options": [{"action_type": "dialogue", "id": "ask_about_drums", "text": "You ask him about the drums you hear in the distance."}, {"action_type": "interaction", "id": "offer_help", "text": "You offer to take over his watch, allowing him some rest."}, {"action_type": "dialogue", "id": "inquire_about_mystery", "text": "You inquire if he has any information about the mysterious figure that's been seen near the walls."}], "safe_functions": [], "scene": "The Shieldbearer, still gazing at the distant horizon where the drums echoed, turns to you as you approach. His eyes re...
2025-10-30 00:49:27,661 [INFO] fortress_director.agents.judge_agent: JudgeAgent.evaluate called with variables
2025-10-30 00:49:34,470 [DEBUG] fortress_director.agents.judge_agent: Model returned: {'consistent': True, 'reason': "The content is consistent with established world, lore, and character logic. The Shieldbearer's curiosity about the drums echoes in his voice as he asks about their source."}
2025-10-30 00:49:34,470 [INFO] fortress_director.agents.judge_agent: Judge verdict: {'consistent': True, 'reason': "The content is consistent with established world, lore, and character logic. The Shieldbearer's curiosity about the drums echoes in his voice as he asks about their source."}
2025-10-30 00:49:34,470 [INFO] fortress_director.orchestrator.orchestrator: Added motif-based option: diplomacy_approach (motif active)
2025-10-30 00:49:34,470 [INFO] fortress_director.orchestrator.orchestrator: Resolving player choice...
2025-10-30 00:49:34,470 [INFO] fortress_director.orchestrator.orchestrator: Player choice resolved: {'id': 'ask_about_drums', 'text': 'You ask him about the drums you hear in the distance.', 'action_type': 'dialogue'}
2025-10-30 00:49:34,470 [DEBUG] fortress_director.orchestrator.orchestrator: Player choice resolved: {"action_type": "dialogue", "id": "ask_about_drums", "text": "You ask him about the drums you hear in the distance."}
2025-10-30 00:49:34,470 [INFO] fortress_director.orchestrator.orchestrator: Applying dynamic metrics for action_type 'dialogue': {'morale': 1, 'knowledge': 2}
2025-10-30 00:49:34,470 [DEBUG] fortress_director.utils.metrics_manager: Adjusting metric 'morale': current=57, delta=1, limits=(0, 100) (cause=action_dialogue)
2025-10-30 00:49:34,470 [DEBUG] fortress_director.utils.metrics_manager: Metric change logged: {'metric': 'morale', 'delta': 1, 'value': 58, 'cause': 'action_dialogue'}
2025-10-30 00:49:34,470 [INFO] fortress_director.utils.metrics_manager: Metric 'morale' updated from 57 to 58 (cause=action_dialogue)
2025-10-30 00:49:34,470 [DEBUG] fortress_director.utils.metrics_manager: Adjusting metric 'knowledge': current=45, delta=2, limits=(0, 100) (cause=action_dialogue)
2025-10-30 00:49:34,470 [DEBUG] fortress_director.utils.metrics_manager: Metric change logged: {'metric': 'knowledge', 'delta': 2, 'value': 47, 'cause': 'action_dialogue'}
2025-10-30 00:49:34,470 [INFO] fortress_director.utils.metrics_manager: Metric 'knowledge' updated from 45 to 47 (cause=action_dialogue)
2025-10-30 00:49:34,470 [DEBUG] fortress_director.orchestrator.orchestrator: Metrics after dynamic changes: {'order': 52, 'morale': 58, 'resources': 41, 'knowledge': 47, 'corruption': 10, 'glitch': 21, 'risk_applied_total': 0, 'major_flag_set': False, 'major_events_triggered': 0, 'major_event_last_turn': None}
2025-10-30 00:49:34,470 [INFO] fortress_director.orchestrator.orchestrator: Action consequence: Your words strengthen village bonds and reveal useful information.
2025-10-30 00:49:34,470 [DEBUG] fortress_director.orchestrator.orchestrator: Character agent input: {"WORLD_CONTEXT": "Turn 4 | Day 1 | Time night\nLocation: entrance\nPlayer: The Shieldbearer — A weary defender holding the western wall. Inventory: oil lamp, patched shield\nWorld constraint: {\"atmosphere\": \"Evening haze shrouds stone ramparts, warm light lingers.\", \"sensory_details\": \"The air carries a metallic tang and earthiness cool breezes brush skin.\"}\nRecent events: The Shieldbearer, weary from his watch, glances at you with a mix of exhaustion and curiosity. The low clouds hang heavy over the battlements, casting an eerie pallor on the landscape. The drums beyon...; The Sh...
2025-10-30 00:49:34,470 [INFO] fortress_director.orchestrator.orchestrator: Calling character_agent.react...
2025-10-30 00:49:34,470 [INFO] fortress_director.agents.character_agent: CharacterAgent.react called with variables: {'WORLD_CONTEXT': 'Turn 4 | Day 1 | Time night\nLocation: entrance\nPlayer: The Shieldbearer — A weary defender holding the western wall. Inventory: oil lamp, patched shield\nWorld constraint: {"atmosphere": "Evening haze shrouds stone ramparts, warm light lingers.", "sensory_details": "The air carries a metallic tang and earthiness cool breezes brush skin."}\nRecent events: The Shieldbearer, weary from his watch, glances at you with a mix of exhaustion and curiosity. The low clouds hang heavy over the battlements, casting an eerie pallor on the landscape. The drums beyon...; The Shieldbearer, his gaze still fixed on the distant horizon where the drums echoed, turns to you as you approach. His eyes reflect a mix of exhaustion and curiosity. \'What brings you here so early?\'...; The Shieldbearer, still gazing at the distant horizon where the drums echoed, turns to you as you approach. His eyes reflect a mix of exhaustion and curiosity. \'What brings you here so early?\' he asks... Recent motifs: communication\nRecent major events: none\nRelationship summary: Rhea trusts the player\nCharacter summary: Rhea is loyal but impulsive; Boris is cautious and calculating. Metrics: {"order": 52, "morale": 57, "resources": 41, "knowledge": 45, "corruption": 10, "glitch": 21, "risk_applied_total": 0, "major_flag_set": false, "major_events_triggered": 0, "major_event_last_turn": null}', 'scene_short': "The Shieldbearer, still gazing at the distant horizon where the drums echoed, turns to you as you approach. His eyes reflect a mix of exhaustion and curiosity. 'What brings you here so early?' he asks.", 'player_choice': 'You ask him about the drums you hear in the distance.', 'atmosphere': 'Night cloaks the world in shadow, a sense of calm overtaking urgency.', 'sensory_details': 'The air is cool and damp against skin distant drumbeats resonate with an ancient power.', 'char_brief': 'Rhea is loyal but impulsive; Boris is cautious and calculating.', 'relationship_summary_from_state': 'Rhea trusts the player', 'player_inventory_brief': 'oil lamp, patched shield', 'memory_layers': ['Turn 1: Approach the Shieldbearer and ask about the drums you hear. -> The Shieldbearer, weary from his watch, glances at you with a mix of exhaustion and curiosity. The l...', 'Turn 2: Ask him about the drums you hear in the distance. -> The Shieldbearer, his gaze still fixed on the distant horizon where the drums echoed, turns to you a...', 'Turn 3: Ask him about the drums you hear in the distance. -> The Shieldbearer, still gazing at the distant horizon where the drums echoed, turns to you as you ap...', 'Memory summary: Turn 1: Approach the Shieldbearer and ask about the drums you hear. -> The Shieldbearer, weary from his watch, glances at you with a mix of exhaustion and curiosity. The l... | Turn 2: Ask him about t...', 'Turn 4: You ask the Shieldbearer about the drums you hear in the distance. -> The Shieldbearer, still gazing at the distant horizon where the drums echoed, turns to you as you ap...'], 'recent_events': "The Shieldbearer, weary from his watch, glances at you with a mix of exhaustion and curiosity. The low clouds hang heavy over the battlements, casting an eerie pallor on the landscape. The drums beyon...; The Shieldbearer, his gaze still fixed on the distant horizon where the drums echoed, turns to you as you approach. His eyes reflect a mix of exhaustion and curiosity. 'What brings you here so early?'...; The Shieldbearer, still gazing at the distant horizon where the drums echoed, turns to you as you approach. His eyes reflect a mix of exhaustion and curiosity. 'What brings you here so early?' he asks...", 'last_major_event': False}
2025-10-30 00:49:45,141 [DEBUG] fortress_director.agents.character_agent: Model returned: {'name': 'Rhea', 'intent': 'observe', 'action': 'stand_vigilance', 'speech': 'I stand vigilant, my senses alert for any sign of danger.', 'effects': {'trust_delta': 100, 'flag_set': ['has_heard_drums'], 'item_change': None, 'status_change': None}}
2025-10-30 00:49:45,141 [INFO] fortress_director.agents.character_agent: Normalized output (dict): [{'name': 'Rhea', 'intent': 'observe', 'action': 'stand_vigilance', 'speech': 'I stand vigilant, my senses alert for any sign of danger.', 'effects': {'trust_delta': 1, 'flag_set': ['has_heard_drums']}, 'safe_functions': []}]
2025-10-30 00:49:45,141 [INFO] fortress_director.orchestrator.orchestrator: Character agent returned output.
2025-10-30 00:49:45,141 [DEBUG] fortress_director.orchestrator.orchestrator: Character agent output: [{"action": "stand_vigilance", "effects": {"flag_set": ["has_heard_drums"], "trust_delta": 1}, "intent": "observe", "name": "Rhea", "safe_functions": [], "speech": "I stand vigilant, my senses alert for any sign of danger."}]
2025-10-30 00:49:45,141 [INFO] fortress_director.orchestrator.orchestrator: Injecting major event effect...
2025-10-30 00:49:45,142 [INFO] fortress_director.orchestrator.orchestrator: Major event effect injected.
2025-10-30 00:49:45,142 [INFO] fortress_director.orchestrator.orchestrator: Submitting reactions to rules engine...
2025-10-30 00:49:45,142 [DEBUG] fortress_director.orchestrator.orchestrator: Submitting reactions to rules engine: [{"action": "stand_vigilance", "effects": {"flag_set": ["has_heard_drums"], "trust_delta": 1}, "intent": "observe", "name": "Rhea", "safe_functions": [], "speech": "I stand vigilant, my senses alert for any sign of danger."}]
2025-10-30 00:49:45,142 [INFO] fortress_director.rules.rules_engine: RulesEngine.process called.
2025-10-30 00:49:45,143 [DEBUG] fortress_director.rules.rules_engine: Input state: {'campaign_id': 'default_campaign', 'turn_limit': 30, 'current_turn': 4, 'rng_seed': 12345, 'scores': {'logic_score': 0, 'emotion_score': 0, 'corruption': 0}, 'flags': ['recent_events'], 'memory_layers': [], 'active_layer': None, 'npc_fragments': {}, 'inventory': [], 'lore': {}, 'turn': 4, 'day': 1, 'time': 'night', 'current_room': 'entrance', 'recent_events': ['The Shieldbearer, weary from his watch, glances at you with a mix of exhaustion and curiosity. The low clouds hang heavy over the battlements, casting an eerie pallor on the landscape. The drums beyon...', "The Shieldbearer, his gaze still fixed on the distant horizon where the drums echoed, turns to you as you approach. His eyes reflect a mix of exhaustion and curiosity. 'What brings you here so early?'...", "The Shieldbearer, still gazing at the distant horizon where the drums echoed, turns to you as you approach. His eyes reflect a mix of exhaustion and curiosity. 'What brings you here so early?' he asks..."], 'recent_motifs': ['communication'], 'world_constraint_from_prev_turn': {'atmosphere': 'Evening haze shrouds stone ramparts, warm light lingers.', 'sensory_details': 'The air carries a metallic tang and earthiness cool breezes brush skin.'}, 'player': {'name': 'The Shieldbearer', 'inventory': ['oil lamp', 'patched shield'], 'stats': {'resolve': 3, 'empathy': 2}, 'summary': 'A weary defender holding the western wall.'}, 'character_summary': 'Rhea is loyal but impulsive; Boris is cautious and calculating.', 'relationship_summary': 'Rhea trusts the player', 'metrics': {'order': 52, 'morale': 58, 'resources': 41, 'knowledge': 47, 'corruption': 10, 'glitch': 21, 'risk_applied_total': 0, 'major_flag_set': False, 'major_events_triggered': 0, 'major_event_last_turn': None}, 'npc_trust': {'Rhea': 1}, 'previous_judge_verdict': {'consistent': True, 'reason': "The content is consistent with established world, lore, and character logic. The Shieldbearer's curiosity about the drums echoes in his voice as he asks about their source.", 'coherence': 100, 'integrity': 100, 'tone_alignment': 100, 'penalty_applied': 'none', 'penalty_magnitude': {}, 'feedback': {}}, 'player_choice_history': ['dialogue', 'dialog', 'dialog', 'dialog'], 'summary_text': 'The day passes quietly.', 'memory_short': ['Turn 1: Approach the Shieldbearer and ask about the drums you hear. -> The Shieldbearer, weary from his watch, glances at you with a mix of exhaustion and curiosity. The l...', 'Turn 2: Ask him about the drums you hear in the distance. -> The Shieldbearer, his gaze still fixed on the distant horizon where the drums echoed, turns to you a...', 'Turn 3: Ask him about the drums you hear in the distance. -> The Shieldbearer, still gazing at the distant horizon where the drums echoed, turns to you as you ap...', 'Memory summary: Turn 1: Approach the Shieldbearer and ask about the drums you hear. -> The Shieldbearer, weary from his watch, glances at you with a mix of exhaustion and curiosity. The l... | Turn 2: Ask him about t...', 'Turn 4: You ask the Shieldbearer about the drums you hear in the distance. -> The Shieldbearer, still gazing at the distant horizon where the drums echoed, turns to you as you ap...'], 'memory_long': [], 'status_effects': []}
2025-10-30 00:49:45,143 [DEBUG] fortress_director.rules.rules_engine: Character events: [{'name': 'Rhea', 'intent': 'observe', 'action': 'stand_vigilance', 'speech': 'I stand vigilant, my senses alert for any sign of danger.', 'effects': {'trust_delta': 1, 'flag_set': ['has_heard_drums']}, 'safe_functions': []}]
2025-10-30 00:49:45,143 [DEBUG] fortress_director.rules.rules_engine: World context: Turn 4 | Day 1 | Time night
Location: entrance
Player: The Shieldbearer — A weary defender holding the western wall. Inventory: oil lamp, patched shield
World constraint: {"atmosphere": "Evening haze shrouds stone ramparts, warm light lingers.", "sensory_details": "The air carries a metallic tang and earthiness cool breezes brush skin."}
Recent events: The Shieldbearer, weary from his watch, glances at you with a mix of exhaustion and curiosity. The low clouds hang heavy over the battlements, casting an eerie pallor on the landscape. The drums beyon...; The Shieldbearer, his gaze still fixed on the distant horizon where the drums echoed, turns to you as you approach. His eyes reflect a mix of exhaustion and curiosity. 'What brings you here so early?'...; The Shieldbearer, still gazing at the distant horizon where the drums echoed, turns to you as you approach. His eyes reflect a mix of exhaustion and curiosity. 'What brings you here so early?' he asks... Recent motifs: communication
Recent major events: none
Relationship summary: Rhea trusts the player
Character summary: Rhea is loyal but impulsive; Boris is cautious and calculating. Metrics: {"order": 52, "morale": 57, "resources": 41, "knowledge": 45, "corruption": 10, "glitch": 21, "risk_applied_total": 0, "major_flag_set": false, "major_events_triggered": 0, "major_event_last_turn": null}, scene: The Shieldbearer, still gazing at the distant horizon where the drums echoed, turns to you as you approach. His eyes reflect a mix of exhaustion and curiosity. 'What brings you here so early?' he asks., player_choice: {'id': 'ask_about_drums', 'text': 'You ask him about the drums you hear in the distance.', 'action_type': 'dialogue'}
2025-10-30 00:49:45,143 [INFO] fortress_director.rules.rules_engine: RulesEngine._validate_tier_one called.
2025-10-30 00:49:45,143 [DEBUG] fortress_director.rules.rules_engine: Validating character event 0: {'name': 'Rhea', 'intent': 'observe', 'action': 'stand_vigilance', 'speech': 'I stand vigilant, my senses alert for any sign of danger.', 'effects': {'trust_delta': 1, 'flag_set': ['has_heard_drums']}, 'safe_functions': []}
2025-10-30 00:49:45,143 [INFO] fortress_director.rules.rules_engine: Tier one validation passed.
2025-10-30 00:49:45,144 [INFO] fortress_director.agents.judge_agent: JudgeAgent.evaluate called with variables
2025-10-30 00:49:51,289 [DEBUG] fortress_director.agents.judge_agent: Model returned: {'consistent': True, 'reason': 'The content is consistent with established world, lore, and character logic. The interaction between the Shieldbearer and the player is natural and in line with their roles as defenders.'}
2025-10-30 00:49:51,289 [INFO] fortress_director.agents.judge_agent: Judge verdict: {'consistent': True, 'reason': 'The content is consistent with established world, lore, and character logic. The interaction between the Shieldbearer and the player is natural and in line with their roles as defenders.'}
2025-10-30 00:49:51,289 [DEBUG] fortress_director.rules.rules_engine: Judge verdict for Rhea: {'consistent': True, 'reason': 'The content is consistent with established world, lore, and character logic. The interaction between the Shieldbearer and the player is natural and in line with their roles as defenders.', 'coherence': 100, 'integrity': 100, 'tone_alignment': 100, 'penalty_applied': 'none', 'penalty_magnitude': {}, 'feedback': {}}
2025-10-30 00:49:51,289 [INFO] fortress_director.rules.rules_engine: Tier two validation passed with penalties: {'glitch_penalty': 0, 'morale_penalty': 0, 'resources_penalty': 0, 'corruption_penalty': 0, 'order_penalty': 0}
2025-10-30 00:49:51,290 [DEBUG] fortress_director.rules.rules_engine: Applying effects for Rhea: {'trust_delta': 1, 'flag_set': ['has_heard_drums']}
2025-10-30 00:49:51,290 [INFO] fortress_director.rules.rules_engine: Trust updated for Rhea: 1 -> 2 (delta: 1)
2025-10-30 00:49:51,291 [INFO] fortress_director.rules.rules_engine: Choice impact applied: knowledge +1 (action_type=dialogue)
2025-10-30 00:49:51,291 [INFO] fortress_director.rules.rules_engine: Relationship summary updated: Rhea trusts the player deeply
2025-10-30 00:49:51,291 [INFO] fortress_director.rules.rules_engine: Judge penalties applied: {'glitch_penalty': 0, 'morale_penalty': 0, 'resources_penalty': 0, 'corruption_penalty': 0, 'order_penalty': 0}
2025-10-30 00:49:51,291 [INFO] fortress_director.rules.rules_engine: State updated by rules engine.
2025-10-30 00:49:51,292 [DEBUG] fortress_director.rules.rules_engine: Output state: {'campaign_id': 'default_campaign', 'turn_limit': 30, 'current_turn': 4, 'rng_seed': 12345, 'scores': {'logic_score': 0, 'emotion_score': 0, 'corruption': 0}, 'flags': ['recent_events', 'has_heard_drums'], 'memory_layers': [], 'active_layer': None, 'npc_fragments': {}, 'inventory': [], 'lore': {}, 'turn': 4, 'day': 1, 'time': 'night', 'current_room': 'entrance', 'recent_events': ['The Shieldbearer, weary from his watch, glances at you with a mix of exhaustion and curiosity. The low clouds hang heavy over the battlements, casting an eerie pallor on the landscape. The drums beyon...', "The Shieldbearer, his gaze still fixed on the distant horizon where the drums echoed, turns to you as you approach. His eyes reflect a mix of exhaustion and curiosity. 'What brings you here so early?'...", "The Shieldbearer, still gazing at the distant horizon where the drums echoed, turns to you as you approach. His eyes reflect a mix of exhaustion and curiosity. 'What brings you here so early?' he asks..."], 'recent_motifs': ['communication'], 'world_constraint_from_prev_turn': {'atmosphere': 'Evening haze shrouds stone ramparts, warm light lingers.', 'sensory_details': 'The air carries a metallic tang and earthiness cool breezes brush skin.'}, 'player': {'name': 'The Shieldbearer', 'inventory': ['oil lamp', 'patched shield'], 'stats': {'resolve': 3, 'empathy': 2}, 'summary': 'A weary defender holding the western wall.'}, 'character_summary': 'Rhea is loyal but impulsive; Boris is cautious and calculating.', 'relationship_summary': 'Rhea trusts the player deeply', 'metrics': {'order': 52, 'morale': 58, 'resources': 41, 'knowledge': 48, 'corruption': 10, 'glitch': 21, 'risk_applied_total': 0, 'major_flag_set': False, 'major_events_triggered': 0, 'major_event_last_turn': None}, 'npc_trust': {'Rhea': 2}, 'previous_judge_verdict': {'consistent': True, 'reason': "The content is consistent with established world, lore, and character logic. The Shieldbearer's curiosity about the drums echoes in his voice as he asks about their source.", 'coherence': 100, 'integrity': 100, 'tone_alignment': 100, 'penalty_applied': 'none', 'penalty_magnitude': {}, 'feedback': {}}, 'player_choice_history': ['dialogue', 'dialog', 'dialog', 'dialog', 'dialogue'], 'summary_text': 'The day passes quietly.', 'memory_short': ['Turn 1: Approach the Shieldbearer and ask about the drums you hear. -> The Shieldbearer, weary from his watch, glances at you with a mix of exhaustion and curiosity. The l...', 'Turn 2: Ask him about the drums you hear in the distance. -> The Shieldbearer, his gaze still fixed on the distant horizon where the drums echoed, turns to you a...', 'Turn 3: Ask him about the drums you hear in the distance. -> The Shieldbearer, still gazing at the distant horizon where the drums echoed, turns to you as you ap...', 'Memory summary: Turn 1: Approach the Shieldbearer and ask about the drums you hear. -> The Shieldbearer, weary from his watch, glances at you with a mix of exhaustion and curiosity. The l... | Turn 2: Ask him about t...', 'Turn 4: You ask the Shieldbearer about the drums you hear in the distance. -> The Shieldbearer, still gazing at the distant horizon where the drums echoed, turns to you as you ap...'], 'memory_long': [], 'status_effects': []}
2025-10-30 00:49:51,292 [INFO] fortress_director.orchestrator.orchestrator: Rules engine accepted updates (turn=5)
2025-10-30 00:49:51,292 [INFO] fortress_director.orchestrator.orchestrator: Applying 1 autonomous actions
2025-10-30 00:49:51,292 [DEBUG] fortress_director.utils.metrics_manager: Adjusting metric 'order': current=52, delta=1, limits=(0, 100) (cause=autonomous_Rhea)
2025-10-30 00:49:51,292 [DEBUG] fortress_director.utils.metrics_manager: Metric change logged: {'metric': 'order', 'delta': 1, 'value': 53, 'cause': 'autonomous_Rhea'}
2025-10-30 00:49:51,292 [INFO] fortress_director.utils.metrics_manager: Metric 'order' updated from 52 to 53 (cause=autonomous_Rhea)
2025-10-30 00:49:51,292 [DEBUG] fortress_director.utils.metrics_manager: Adjusting metric 'morale': current=58, delta=1, limits=(0, 100) (cause=autonomous_Rhea)
2025-10-30 00:49:51,292 [DEBUG] fortress_director.utils.metrics_manager: Metric change logged: {'metric': 'morale', 'delta': 1, 'value': 59, 'cause': 'autonomous_Rhea'}
2025-10-30 00:49:51,293 [INFO] fortress_director.utils.metrics_manager: Metric 'morale' updated from 58 to 59 (cause=autonomous_Rhea)
2025-10-30 00:49:51,293 [INFO] fortress_director.orchestrator.orchestrator: Updating state and persisting...
2025-10-30 00:49:51,293 [INFO] fortress_director.orchestrator.orchestrator: Advanced to Day 2, Dawn
2025-10-30 00:49:51,293 [DEBUG] fortress_director.rules.rules_engine: Status effects ticked: []
2025-10-30 00:49:51,293 [INFO] fortress_director.rules.rules_engine: Environmental effects applied with seed 12345
2025-10-30 00:49:51,293 [DEBUG] fortress_director.orchestrator.orchestrator: State after update: {"active_layer": null, "campaign_id": "default_campaign", "character_summary": "Rhea is loyal but impulsive; Boris is cautious and calculating.", "current_room": "entrance", "current_turn": 5, "day": 2, "flags": ["recent_events", "has_heard_drums"], "inventory": [], "lore": {}, "memory_layers": [], "memory_long": [], "memory_short": ["Turn 2: Ask him about the drums you hear in the distance. -> The Shieldbearer, his gaze still fixed on the distant horizon where the drums echoed, turns to you a...", "Turn 3: Ask him about the drums you hear in the distance. -> The Shieldbearer, still gazing ...
2025-10-30 00:49:51,294 [DEBUG] fortress_director.orchestrator.orchestrator: State persisted to C:\Users\Fahri\OneDrive\Masaüstü\oyun\fortress_director\data\world_state.json (turn=5)
2025-10-30 00:49:51,294 [INFO] fortress_director.orchestrator.orchestrator: Executing safe function queue...
2025-10-30 00:49:51,295 [INFO] fortress_director.orchestrator.orchestrator: Safe function queue executed.
2025-10-30 00:49:51,295 [DEBUG] fortress_director.orchestrator.orchestrator: State snapshot loaded from C:\Users\Fahri\OneDrive\Masaüstü\oyun\fortress_director\data\world_state.json (turn=5)
2025-10-30 00:49:51,296 [DEBUG] fortress_director.orchestrator.orchestrator: State persisted to C:\Users\Fahri\OneDrive\Masaüstü\oyun\fortress_director\data\world_state.json (turn=5)
2025-10-30 00:49:51,296 [DEBUG] fortress_director.orchestrator.orchestrator: State snapshot loaded from C:\Users\Fahri\OneDrive\Masaüstü\oyun\fortress_director\data\world_state.json (turn=5)
2025-10-30 00:49:51,296 [DEBUG] fortress_director.utils.metrics_manager: MetricManager initialised with metrics: {'order': 53, 'morale': 59, 'resources': 41, 'knowledge': 47, 'corruption': 10, 'glitch': 21, 'risk_applied_total': 0, 'major_flag_set': False, 'major_events_triggered': 0, 'major_event_last_turn': None}
2025-10-30 00:49:51,296 [DEBUG] fortress_director.orchestrator.orchestrator: Final metrics snapshot: {'order': 53, 'morale': 59, 'resources': 41, 'knowledge': 47, 'corruption': 10, 'glitch': 21, 'risk_applied_total': 0, 'major_flag_set': False, 'major_events_triggered': 0, 'major_event_last_turn': None}
2025-10-30 00:49:51,296 [INFO] fortress_director.orchestrator.orchestrator: Win/loss status after turn: {'status': 'ongoing', 'reason': 'conditions_not_met', 'description': 'Oyun devam ediyor...'}
2025-10-30 00:49:51,296 [INFO] fortress_director.orchestrator.orchestrator: Turn summary: The day passes quietly.
2025-10-30 00:49:51,296 [INFO] fortress_director.orchestrator.orchestrator: Turn result built.
2025-10-30 00:49:51,297 [DEBUG] fortress_director.orchestrator.orchestrator: Turn result before validation: {"WORLD_CONTEXT": "Turn 4 | Day 1 | Time night\nLocation: entrance\nPlayer: The Shieldbearer — A weary defender holding the western wall. Inventory: oil lamp, patched shield\nWorld constraint: {\"atmosphere\": \"Evening haze shrouds stone ramparts, warm light lingers.\", \"sensory_details\": \"The air carries a metallic tang and earthiness cool breezes brush skin.\"}\nRecent events: The Shieldbearer, weary from his watch, glances at you with a mix of exhaustion and curiosity. The low clouds hang heavy over the battlements, casting an eerie pallor on the landscape. The drums beyon...; The Sh...
2025-10-30 00:49:51,297 [INFO] fortress_director.orchestrator.orchestrator: Turn output validated successfully.
2025-10-30 00:49:51,297 [INFO] fortress_director.orchestrator.orchestrator: Turn completed successfully.
