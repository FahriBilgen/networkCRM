2025-10-24 14:36:29,482 [DEBUG] root: Logging configured (console=INFO, file=DEBUG, path=C:\Users\Fahri\OneDrive\Masaüstü\oyun\fortress_director\logs\turn_20251024_113629.log)
2025-10-24 14:36:29,482 [DEBUG] __main__: Logging configured via CLI (console level=INFO, path=C:\Users\Fahri\OneDrive\Masaüstü\oyun\fortress_director\logs\turn_20251024_113629.log)
2025-10-24 14:36:29,482 [INFO] __main__: Detailed logs written to C:\Users\Fahri\OneDrive\Masaüstü\oyun\fortress_director\logs\turn_20251024_113629.log
2025-10-24 14:36:29,499 [INFO] fortress_director.codeaware.function_registry: Registering safe function: change_weather
2025-10-24 14:36:29,514 [INFO] fortress_director.codeaware.function_registry: Safe function 'change_weather' registered successfully.
2025-10-24 14:36:29,515 [INFO] fortress_director.codeaware.function_registry: Registering safe function: spawn_item
2025-10-24 14:36:29,515 [INFO] fortress_director.codeaware.function_registry: Safe function 'spawn_item' registered successfully.
2025-10-24 14:36:29,515 [INFO] fortress_director.codeaware.function_registry: Registering safe function: move_npc
2025-10-24 14:36:29,515 [INFO] fortress_director.codeaware.function_registry: Safe function 'move_npc' registered successfully.
2025-10-24 14:36:29,515 [INFO] fortress_director.codeaware.function_registry: Registering safe function: adjust_logic
2025-10-24 14:36:29,516 [INFO] fortress_director.codeaware.function_registry: Safe function 'adjust_logic' registered successfully.
2025-10-24 14:36:29,516 [INFO] fortress_director.codeaware.function_registry: Registering safe function: adjust_emotion
2025-10-24 14:36:29,516 [INFO] fortress_director.codeaware.function_registry: Safe function 'adjust_emotion' registered successfully.
2025-10-24 14:36:29,516 [INFO] fortress_director.codeaware.function_registry: Registering safe function: raise_corruption
2025-10-24 14:36:29,516 [INFO] fortress_director.codeaware.function_registry: Safe function 'raise_corruption' registered successfully.
2025-10-24 14:36:29,518 [INFO] fortress_director.codeaware.function_registry: Registering safe function: advance_turn
2025-10-24 14:36:29,518 [INFO] fortress_director.codeaware.function_registry: Safe function 'advance_turn' registered successfully.
2025-10-24 14:36:29,518 [INFO] fortress_director.codeaware.function_registry: Registering safe function: modify_resources
2025-10-24 14:36:29,518 [INFO] fortress_director.codeaware.function_registry: Safe function 'modify_resources' registered successfully.
2025-10-24 14:36:29,518 [INFO] fortress_director.codeaware.function_registry: Registering safe function: adjust_metric
2025-10-24 14:36:29,518 [INFO] fortress_director.codeaware.function_registry: Safe function 'adjust_metric' registered successfully.
2025-10-24 14:36:29,518 [INFO] fortress_director.orchestrator.orchestrator: run_turn called (player_choice_id=None)
2025-10-24 14:36:29,518 [DEBUG] fortress_director.orchestrator.orchestrator: Resetting function validator and creating checkpoint: {'phase': 'turn_start'}
2025-10-24 14:36:29,518 [DEBUG] fortress_director.orchestrator.orchestrator: State snapshot loaded from C:\Users\Fahri\OneDrive\Masaüstü\oyun\fortress_director\data\world_state.json (turn=0)
2025-10-24 14:36:29,518 [INFO] fortress_director.codeaware.rollback_system: Checkpoint created (turn=0, call=None)
2025-10-24 14:36:29,518 [INFO] fortress_director.orchestrator.orchestrator: Turn execution started.
2025-10-24 14:36:29,518 [DEBUG] fortress_director.orchestrator.orchestrator: State snapshot loaded from C:\Users\Fahri\OneDrive\Masaüstü\oyun\fortress_director\data\world_state.json (turn=0)
2025-10-24 14:36:29,518 [DEBUG] fortress_director.orchestrator.orchestrator: Pre-turn state snapshot: {"active_layer": null, "campaign_id": "default_campaign", "character_summary": "Rhea is loyal but impulsive; Boris is cautious and calculating.", "current_room": "entrance", "current_turn": 0, "day": 1, "flags": [], "inventory": [], "items": {}, "lore": {}, "memory_layers": [], "metrics": {"corruption": 10, "glitch": 12, "knowledge": 45, "major_event_last_turn": null, "major_events_triggered": 0, "major_flag_set": false, "morale": 50, "order": 50, "resources": 40, "risk_applied_total": 0}, "npc_fragments": {}, "npc_trust": {}, "player": {"inventory": ["oil lamp", "patched shield"], "name": ...
2025-10-24 14:36:29,520 [DEBUG] fortress_director.utils.metrics_manager: MetricManager initialised with metrics: {'order': 50, 'morale': 50, 'resources': 40, 'knowledge': 45, 'corruption': 10, 'glitch': 12, 'risk_applied_total': 0, 'major_flag_set': False, 'major_events_triggered': 0, 'major_event_last_turn': None}
2025-10-24 14:36:29,520 [DEBUG] fortress_director.orchestrator.orchestrator: Metrics at turn start: {'order': 50, 'morale': 50, 'resources': 40, 'knowledge': 45, 'corruption': 10, 'glitch': 12, 'risk_applied_total': 0, 'major_flag_set': False, 'major_events_triggered': 0, 'major_event_last_turn': None}
2025-10-24 14:36:29,520 [INFO] fortress_director.utils.glitch_manager: Resolving glitch (turn=1, seed=12345, current_glitch=12)
2025-10-24 14:36:29,521 [DEBUG] fortress_director.utils.glitch_manager: Metrics before glitch resolution: {'order': 50, 'morale': 50, 'resources': 40, 'knowledge': 45, 'corruption': 10, 'glitch': 12, 'risk_applied_total': 0, 'major_flag_set': False, 'major_events_triggered': 0, 'major_event_last_turn': None}
2025-10-24 14:36:29,521 [DEBUG] fortress_director.utils.metrics_manager: Adjusting metric 'glitch': current=12, delta=1, limits=(0, 100) (cause=glitch:cosmetic_noise)
2025-10-24 14:36:29,521 [DEBUG] fortress_director.utils.metrics_manager: Metric change logged: {'metric': 'glitch', 'delta': 1, 'value': 13, 'cause': 'glitch:cosmetic_noise'}
2025-10-24 14:36:29,521 [INFO] fortress_director.utils.metrics_manager: Metric 'glitch' updated from 12 to 13 (cause=glitch:cosmetic_noise)
2025-10-24 14:36:29,521 [INFO] fortress_director.utils.glitch_manager: Glitch roll complete: roll=7, triggered_loss=False
2025-10-24 14:36:29,521 [DEBUG] fortress_director.utils.glitch_manager: Metrics after glitch resolution: {'order': 50, 'morale': 50, 'resources': 40, 'knowledge': 45, 'corruption': 10, 'glitch': 13, 'risk_applied_total': 0, 'major_flag_set': False, 'major_events_triggered': 0, 'major_event_last_turn': None}
2025-10-24 14:36:29,521 [DEBUG] fortress_director.utils.glitch_manager: Glitch effects applied: ['Minor static ripples along the parapets.']
2025-10-24 14:36:29,521 [INFO] fortress_director.orchestrator.orchestrator: Glitch resolution outcome: roll=7, triggered_loss=False
2025-10-24 14:36:29,521 [DEBUG] fortress_director.orchestrator.orchestrator: Metrics after glitch resolution: {'order': 50, 'morale': 50, 'resources': 40, 'knowledge': 45, 'corruption': 10, 'glitch': 13, 'risk_applied_total': 0, 'major_flag_set': False, 'major_events_triggered': 0, 'major_event_last_turn': None}
2025-10-24 14:36:29,521 [INFO] fortress_director.orchestrator.orchestrator: World context built.
2025-10-24 14:36:29,522 [DEBUG] fortress_director.orchestrator.orchestrator: World context payload: Turn 0 | Day 1 | Time dawn
Location: entrance
Player: The Shieldbearer — A weary defender holding the western wall.
Inventory: oil lamp, patched shield
World constraint: {"atmosphere": "low clouds hug the battlements", "sensory_details": "Drums thud beyond the walls while the wind carries grit."}
Recent events: none
Recent motifs: none
Recent major events: none
Relationship summary: Rhea trusts the player; Boris weighs every trade.
Character summary: Rhea is loyal but impulsive; Boris is cautious and calculating.
Metrics: {"order": 50, "morale": 50, "resources": 40, "knowledge": 45, "corruption": 10, "glitch": 13, "risk_applied_total": 0, "major_flag_set": false, "major_events_triggered": 0, "major_event_last_turn": null}
2025-10-24 14:36:29,522 [INFO] fortress_director.orchestrator.orchestrator: Starting turn 0 in room entrance
2025-10-24 14:36:29,522 [DEBUG] fortress_director.orchestrator.orchestrator: World agent input: {"WORLD_CONTEXT": "Turn 0 | Day 1 | Time dawn\nLocation: entrance\nPlayer: The Shieldbearer — A weary defender holding the western wall.\nInventory: oil lamp, patched shield\nWorld constraint: {\"atmosphere\": \"low clouds hug the battlements\", \"sensory_details\": \"Drums thud beyond the walls while the wind carries grit.\"}\nRecent events: none\nRecent motifs: none\nRecent major events: none\nRelationship summary: Rhea trusts the player; Boris weighs every trade.\nCharacter summary: Rhea is loyal but impulsive; Boris is cautious and calculating.\nMetrics: {\"order\": 50, \"morale\": 50, ...
2025-10-24 14:36:29,522 [INFO] fortress_director.orchestrator.orchestrator: Calling world_agent.describe...
2025-10-24 14:36:29,523 [INFO] fortress_director.agents.world_agent: WorldAgent.describe called with variables: {'WORLD_CONTEXT': 'Turn 0 | Day 1 | Time dawn\nLocation: entrance\nPlayer: The Shieldbearer — A weary defender holding the western wall.\nInventory: oil lamp, patched shield\nWorld constraint: {"atmosphere": "low clouds hug the battlements", "sensory_details": "Drums thud beyond the walls while the wind carries grit."}\nRecent events: none\nRecent motifs: none\nRecent major events: none\nRelationship summary: Rhea trusts the player; Boris weighs every trade.\nCharacter summary: Rhea is loyal but impulsive; Boris is cautious and calculating.\nMetrics: {"order": 50, "morale": 50, "resources": 40, "knowledge": 45, "corruption": 10, "glitch": 13, "risk_applied_total": 0, "major_flag_set": false, "major_events_triggered": 0, "major_event_last_turn": null}', 'room': 'entrance'}
2025-10-24 14:36:37,350 [DEBUG] fortress_director.agents.world_agent: Model returned: {'atmosphere': 'Dawn breaks, a new day at the western wall.', 'sensory_details': 'The chill morning air bites as dust motes dance in the shafts of light piercing through low clouds.'}
2025-10-24 14:36:37,350 [INFO] fortress_director.agents.world_agent: World description: {'atmosphere': 'Dawn breaks, a new day at the western wall.', 'sensory_details': 'The chill morning air bites as dust motes dance in the shafts of light piercing through low clouds.'}
2025-10-24 14:36:37,350 [INFO] fortress_director.orchestrator.orchestrator: World agent returned output.
2025-10-24 14:36:37,350 [DEBUG] fortress_director.orchestrator.orchestrator: World agent output: {"atmosphere": "Dawn breaks, a new day at the western wall.", "sensory_details": "The chill morning air bites as dust motes dance in the shafts of light piercing through low clouds."}
2025-10-24 14:36:37,351 [DEBUG] fortress_director.orchestrator.orchestrator: Event agent input: {"WORLD_CONTEXT": "Turn 0 | Day 1 | Time dawn\nLocation: entrance\nPlayer: The Shieldbearer — A weary defender holding the western wall.\nInventory: oil lamp, patched shield\nWorld constraint: {\"atmosphere\": \"low clouds hug the battlements\", \"sensory_details\": \"Drums thud beyond the walls while the wind carries grit.\"}\nRecent events: none\nRecent motifs: none\nRecent major events: none\nRelationship summary: Rhea trusts the player; Boris weighs every trade.\nCharacter summary: Rhea is loyal but impulsive; Boris is cautious and calculating.\nMetrics: {\"order\": 50, \"morale\": 50, ...
2025-10-24 14:36:37,351 [INFO] fortress_director.orchestrator.orchestrator: Calling event_agent.generate...
2025-10-24 14:36:37,351 [INFO] fortress_director.agents.event_agent: EventAgent.generate called with variables: {'WORLD_CONTEXT': 'Turn 0 | Day 1 | Time dawn\nLocation: entrance\nPlayer: The Shieldbearer — A weary defender holding the western wall.\nInventory: oil lamp, patched shield\nWorld constraint: {"atmosphere": "low clouds hug the battlements", "sensory_details": "Drums thud beyond the walls while the wind carries grit."}\nRecent events: none\nRecent motifs: none\nRecent major events: none\nRelationship summary: Rhea trusts the player; Boris weighs every trade.\nCharacter summary: Rhea is loyal but impulsive; Boris is cautious and calculating.\nMetrics: {"order": 50, "morale": 50, "resources": 40, "knowledge": 45, "corruption": 10, "glitch": 13, "risk_applied_total": 0, "major_flag_set": false, "major_events_triggered": 0, "major_event_last_turn": null}', 'day': 1, 'time': 'dawn', 'room': 'entrance', 'recent_events': 'none', 'world_constraint_from_prev_turn': '{"atmosphere": "low clouds hug the battlements", "sensory_details": "Drums thud beyond the walls while the wind carries grit."}', 'recent_motifs': 'none', 'lore_continuity_weight': 0}
2025-10-24 14:37:05,141 [DEBUG] fortress_director.agents.event_agent: Model returned: {'scene': 'The Shieldbearer, standing at the entrance of Lornhaven, gazes out at the low clouds that hug the battlements. The wind carries grit and the distant drums thud ominously.', 'options': [{'id': '1', 'text': 'Approach Rhea and ask about the drums you hear.', 'action_type': 'dialogue'}, {'id': '2', 'text': "Check the oil lamp to ensure it's lit.", 'action_type': 'interaction'}, {'id': '3', 'text': 'Head out to investigate the drums yourself.', 'action_type': 'action'}], 'major_event': False, 'safe_functions': []}
2025-10-24 14:37:05,141 [INFO] fortress_director.agents.event_agent: Normalized event output: {'scene': 'The Shieldbearer, standing at the entrance of Lornhaven, gazes out at the low clouds that hug the battlements. The wind carries grit and the distant drums thud ominously.', 'options': [{'id': '1', 'text': 'Approach Rhea and ask about the drums you hear.', 'action_type': 'dialogue'}, {'id': '2', 'text': "Check the oil lamp to ensure it's lit.", 'action_type': 'interaction'}, {'id': '3', 'text': 'Head out to investigate the drums yourself.', 'action_type': 'action'}], 'major_event': False, 'safe_functions': []}
2025-10-24 14:37:05,141 [INFO] fortress_director.orchestrator.orchestrator: Event agent returned output.
2025-10-24 14:37:05,141 [DEBUG] fortress_director.orchestrator.orchestrator: Event agent output: {"major_event": false, "options": [{"action_type": "dialogue", "id": "1", "text": "Approach Rhea and ask about the drums you hear."}, {"action_type": "interaction", "id": "2", "text": "Check the oil lamp to ensure it's lit."}, {"action_type": "action", "id": "3", "text": "Head out to investigate the drums yourself."}], "safe_functions": [], "scene": "The Shieldbearer, standing at the entrance of Lornhaven, gazes out at the low clouds that hug the battlements. The wind carries grit and the distant drums thud ominously."}
2025-10-24 14:37:05,141 [INFO] fortress_director.orchestrator.orchestrator: Resolving player choice...
2025-10-24 14:37:05,141 [INFO] fortress_director.orchestrator.orchestrator: Player choice resolved: {'id': '1', 'text': 'Approach Rhea and ask about the drums you hear.', 'action_type': 'dialogue'}
2025-10-24 14:37:05,141 [DEBUG] fortress_director.orchestrator.orchestrator: Player choice resolved: {"action_type": "dialogue", "id": "1", "text": "Approach Rhea and ask about the drums you hear."}
2025-10-24 14:37:05,141 [DEBUG] fortress_director.orchestrator.orchestrator: Character agent input: {"WORLD_CONTEXT": "Turn 0 | Day 1 | Time dawn\nLocation: entrance\nPlayer: The Shieldbearer — A weary defender holding the western wall.\nInventory: oil lamp, patched shield\nWorld constraint: {\"atmosphere\": \"low clouds hug the battlements\", \"sensory_details\": \"Drums thud beyond the walls while the wind carries grit.\"}\nRecent events: none\nRecent motifs: none\nRecent major events: none\nRelationship summary: Rhea trusts the player; Boris weighs every trade.\nCharacter summary: Rhea is loyal but impulsive; Boris is cautious and calculating.\nMetrics: {\"order\": 50, \"morale\": 50, ...
2025-10-24 14:37:05,141 [INFO] fortress_director.orchestrator.orchestrator: Calling character_agent.react...
2025-10-24 14:37:05,141 [INFO] fortress_director.agents.character_agent: CharacterAgent.react called with variables: {'WORLD_CONTEXT': 'Turn 0 | Day 1 | Time dawn\nLocation: entrance\nPlayer: The Shieldbearer — A weary defender holding the western wall.\nInventory: oil lamp, patched shield\nWorld constraint: {"atmosphere": "low clouds hug the battlements", "sensory_details": "Drums thud beyond the walls while the wind carries grit."}\nRecent events: none\nRecent motifs: none\nRecent major events: none\nRelationship summary: Rhea trusts the player; Boris weighs every trade.\nCharacter summary: Rhea is loyal but impulsive; Boris is cautious and calculating.\nMetrics: {"order": 50, "morale": 50, "resources": 40, "knowledge": 45, "corruption": 10, "glitch": 13, "risk_applied_total": 0, "major_flag_set": false, "major_events_triggered": 0, "major_event_last_turn": null}', 'scene_short': 'The Shieldbearer, standing at the entrance of Lornhaven, gazes out at the low clouds that hug the battlements. The wind carries grit and the distant drums thud ominously.', 'player_choice': 'Approach Rhea and ask about the drums you hear.', 'atmosphere': 'Dawn breaks, a new day at the western wall.', 'sensory_details': 'The chill morning air bites as dust motes dance in the shafts of light piercing through low clouds.', 'char_brief': 'Rhea is loyal but impulsive; Boris is cautious and calculating.', 'relationship_summary_from_state': 'Rhea trusts the player; Boris weighs every trade.', 'player_inventory_brief': 'oil lamp, patched shield'}
2025-10-24 14:37:14,164 [DEBUG] fortress_director.agents.character_agent: Model returned: {'name': 'Rhea', 'intent': 'Listen to the wind', 'action': "Turn to the north and listen to the wind's whispers.", 'speech': 'The wind whispers secrets through the clouds, but I cannot decipher them. I sense a faint rhythm, like the pounding of a heart.'}
2025-10-24 14:37:14,164 [INFO] fortress_director.agents.character_agent: Normalized output (dict): [{'name': 'Rhea', 'intent': 'Listen to the wind', 'action': "Turn to the north and listen to the wind's whispers.", 'speech': 'The wind whispers secrets through the clouds, but I cannot decipher them. I sense a faint rhythm, like the pounding of a heart.', 'effects': {}}]
2025-10-24 14:37:14,164 [INFO] fortress_director.orchestrator.orchestrator: Character agent returned output.
2025-10-24 14:37:14,164 [DEBUG] fortress_director.orchestrator.orchestrator: Character agent output: [{"action": "Turn to the north and listen to the wind's whispers.", "effects": {}, "intent": "Listen to the wind", "name": "Rhea", "speech": "The wind whispers secrets through the clouds, but I cannot decipher them. I sense a faint rhythm, like the pounding of a heart."}]
2025-10-24 14:37:14,164 [INFO] fortress_director.orchestrator.orchestrator: Injecting major event effect...
2025-10-24 14:37:14,165 [INFO] fortress_director.orchestrator.orchestrator: Major event effect injected.
2025-10-24 14:37:14,165 [INFO] fortress_director.orchestrator.orchestrator: Submitting reactions to rules engine...
2025-10-24 14:37:14,165 [DEBUG] fortress_director.orchestrator.orchestrator: Submitting reactions to rules engine: [{"action": "Turn to the north and listen to the wind's whispers.", "effects": {}, "intent": "Listen to the wind", "name": "Rhea", "speech": "The wind whispers secrets through the clouds, but I cannot decipher them. I sense a faint rhythm, like the pounding of a heart."}]
2025-10-24 14:37:14,165 [INFO] fortress_director.rules.rules_engine: RulesEngine.process called.
2025-10-24 14:37:14,165 [DEBUG] fortress_director.rules.rules_engine: Input state: {'campaign_id': 'default_campaign', 'turn_limit': 10, 'current_turn': 0, 'rng_seed': 12345, 'scores': {'logic_score': 0, 'emotion_score': 0, 'corruption': 0}, 'flags': [], 'memory_layers': [], 'active_layer': None, 'npc_fragments': {}, 'inventory': [], 'lore': {}, 'turn': 0, 'day': 1, 'time': 'dawn', 'current_room': 'entrance', 'recent_events': [], 'recent_motifs': [], 'world_constraint_from_prev_turn': {'atmosphere': 'low clouds hug the battlements', 'sensory_details': 'Drums thud beyond the walls while the wind carries grit.'}, 'player': {'name': 'The Shieldbearer', 'inventory': ['oil lamp', 'patched shield'], 'stats': {'resolve': 3, 'empathy': 2}, 'summary': 'A weary defender holding the western wall.'}, 'character_summary': 'Rhea is loyal but impulsive; Boris is cautious and calculating.', 'relationship_summary': 'Rhea trusts the player; Boris weighs every trade.', 'metrics': {'order': 50, 'morale': 50, 'resources': 40, 'knowledge': 45, 'corruption': 10, 'glitch': 13, 'risk_applied_total': 0, 'major_flag_set': False, 'major_events_triggered': 0, 'major_event_last_turn': None}, 'npc_trust': {}, 'status_effects': [], 'items': {}, 'recent_major_events': []}
2025-10-24 14:37:14,165 [DEBUG] fortress_director.rules.rules_engine: Character events: [{'name': 'Rhea', 'intent': 'Listen to the wind', 'action': "Turn to the north and listen to the wind's whispers.", 'speech': 'The wind whispers secrets through the clouds, but I cannot decipher them. I sense a faint rhythm, like the pounding of a heart.', 'effects': {}}]
2025-10-24 14:37:14,166 [DEBUG] fortress_director.rules.rules_engine: World context: Turn 0 | Day 1 | Time dawn
Location: entrance
Player: The Shieldbearer — A weary defender holding the western wall.
Inventory: oil lamp, patched shield
World constraint: {"atmosphere": "low clouds hug the battlements", "sensory_details": "Drums thud beyond the walls while the wind carries grit."}
Recent events: none
Recent motifs: none
Recent major events: none
Relationship summary: Rhea trusts the player; Boris weighs every trade.
Character summary: Rhea is loyal but impulsive; Boris is cautious and calculating.
Metrics: {"order": 50, "morale": 50, "resources": 40, "knowledge": 45, "corruption": 10, "glitch": 13, "risk_applied_total": 0, "major_flag_set": false, "major_events_triggered": 0, "major_event_last_turn": null}, scene: The Shieldbearer, standing at the entrance of Lornhaven, gazes out at the low clouds that hug the battlements. The wind carries grit and the distant drums thud ominously., player_choice: {'id': '1', 'text': 'Approach Rhea and ask about the drums you hear.', 'action_type': 'dialogue'}
2025-10-24 14:37:14,166 [INFO] fortress_director.rules.rules_engine: RulesEngine._validate_tier_one called.
2025-10-24 14:37:14,166 [DEBUG] fortress_director.rules.rules_engine: Validating character event 0: {'name': 'Rhea', 'intent': 'Listen to the wind', 'action': "Turn to the north and listen to the wind's whispers.", 'speech': 'The wind whispers secrets through the clouds, but I cannot decipher them. I sense a faint rhythm, like the pounding of a heart.', 'effects': {}}
2025-10-24 14:37:14,166 [INFO] fortress_director.rules.rules_engine: Tier one validation passed.
2025-10-24 14:37:14,166 [INFO] fortress_director.agents.judge_agent: JudgeAgent.evaluate called with variables: {'WORLD_CONTEXT': 'Turn 0 | Day 1 | Time dawn\nLocation: entrance\nPlayer: The Shieldbearer — A weary defender holding the western wall.\nInventory: oil lamp, patched shield\nWorld constraint: {"atmosphere": "low clouds hug the battlements", "sensory_details": "Drums thud beyond the walls while the wind carries grit."}\nRecent events: none\nRecent motifs: none\nRecent major events: none\nRelationship summary: Rhea trusts the player; Boris weighs every trade.\nCharacter summary: Rhea is loyal but impulsive; Boris is cautious and calculating.\nMetrics: {"order": 50, "morale": 50, "resources": 40, "knowledge": 45, "corruption": 10, "glitch": 13, "risk_applied_total": 0, "major_flag_set": false, "major_events_triggered": 0, "major_event_last_turn": null}', 'content': '{"scene": "The Shieldbearer, standing at the entrance of Lornhaven, gazes out at the low clouds that hug the battlements. The wind carries grit and the distant drums thud ominously.", "player_choice": {"id": "1", "text": "Approach Rhea and ask about the drums you hear.", "action_type": "dialogue"}, "character_update": {"name": "Rhea", "intent": "Listen to the wind", "action": "Turn to the north and listen to the wind\'s whispers.", "speech": "The wind whispers secrets through the clouds, but I cannot decipher them. I sense a faint rhythm, like the pounding of a heart.", "effects": {}}}', 'tolerance': 1}
2025-10-24 14:37:20,814 [DEBUG] fortress_director.agents.judge_agent: Model returned: {'consistent': True, 'reason': "The content is consistent with the established world, lore, and character logic. The scene and player choice are in line with the Shieldbearer's role as a defender at the entrance of Lornhaven."}
2025-10-24 14:37:20,815 [INFO] fortress_director.agents.judge_agent: Judge verdict: {'consistent': True, 'reason': "The content is consistent with the established world, lore, and character logic. The scene and player choice are in line with the Shieldbearer's role as a defender at the entrance of Lornhaven."}
2025-10-24 14:37:20,815 [DEBUG] fortress_director.rules.rules_engine: Judge verdict for Rhea: {'consistent': True, 'reason': "The content is consistent with the established world, lore, and character logic. The scene and player choice are in line with the Shieldbearer's role as a defender at the entrance of Lornhaven."}
2025-10-24 14:37:20,815 [INFO] fortress_director.rules.rules_engine: Tier two validation passed.
2025-10-24 14:37:20,815 [DEBUG] fortress_director.rules.rules_engine: Applying effects for Rhea: {}
2025-10-24 14:37:20,815 [INFO] fortress_director.rules.rules_engine: State updated by rules engine.
2025-10-24 14:37:20,815 [DEBUG] fortress_director.rules.rules_engine: Output state: {'campaign_id': 'default_campaign', 'turn_limit': 10, 'current_turn': 0, 'rng_seed': 12345, 'scores': {'logic_score': 0, 'emotion_score': 0, 'corruption': 0}, 'flags': [], 'memory_layers': [], 'active_layer': None, 'npc_fragments': {}, 'inventory': [], 'lore': {}, 'turn': 0, 'day': 1, 'time': 'dawn', 'current_room': 'entrance', 'recent_events': [], 'recent_motifs': [], 'world_constraint_from_prev_turn': {'atmosphere': 'low clouds hug the battlements', 'sensory_details': 'Drums thud beyond the walls while the wind carries grit.'}, 'player': {'name': 'The Shieldbearer', 'inventory': ['oil lamp', 'patched shield'], 'stats': {'resolve': 3, 'empathy': 2}, 'summary': 'A weary defender holding the western wall.'}, 'character_summary': 'Rhea is loyal but impulsive; Boris is cautious and calculating.', 'relationship_summary': 'Rhea trusts the player; Boris weighs every trade.', 'metrics': {'order': 50, 'morale': 50, 'resources': 40, 'knowledge': 45, 'corruption': 10, 'glitch': 13, 'risk_applied_total': 0, 'major_flag_set': False, 'major_events_triggered': 0, 'major_event_last_turn': None}, 'npc_trust': {}, 'status_effects': [], 'items': {}, 'recent_major_events': []}
2025-10-24 14:37:20,815 [INFO] fortress_director.orchestrator.orchestrator: Rules engine accepted updates (turn=1)
2025-10-24 14:37:20,815 [INFO] fortress_director.orchestrator.orchestrator: Updating state and persisting...
2025-10-24 14:37:20,815 [DEBUG] fortress_director.orchestrator.orchestrator: State after update: {"active_layer": null, "campaign_id": "default_campaign", "character_summary": "Rhea is loyal but impulsive; Boris is cautious and calculating.", "current_room": "entrance", "current_turn": 1, "day": 1, "flags": [], "inventory": [], "items": {}, "lore": {}, "memory_layers": [], "metrics": {"corruption": 10, "glitch": 13, "knowledge": 45, "major_event_last_turn": null, "major_events_triggered": 0, "major_flag_set": false, "morale": 50, "order": 50, "resources": 40, "risk_applied_total": 0}, "npc_fragments": {}, "npc_trust": {}, "player": {"inventory": ["oil lamp", "patched shield"], "name": ...
2025-10-24 14:37:20,815 [DEBUG] fortress_director.orchestrator.orchestrator: State persisted to C:\Users\Fahri\OneDrive\Masaüstü\oyun\fortress_director\data\world_state.json (turn=1)
2025-10-24 14:37:20,815 [INFO] fortress_director.orchestrator.orchestrator: Executing safe function queue...
2025-10-24 14:37:20,815 [INFO] fortress_director.orchestrator.orchestrator: Safe function queue executed.
2025-10-24 14:37:20,815 [DEBUG] fortress_director.orchestrator.orchestrator: State snapshot loaded from C:\Users\Fahri\OneDrive\Masaüstü\oyun\fortress_director\data\world_state.json (turn=1)
2025-10-24 14:37:20,815 [DEBUG] fortress_director.utils.metrics_manager: MetricManager initialised with metrics: {'order': 50, 'morale': 50, 'resources': 40, 'knowledge': 45, 'corruption': 10, 'glitch': 13, 'risk_applied_total': 0, 'major_flag_set': False, 'major_events_triggered': 0, 'major_event_last_turn': None}
2025-10-24 14:37:20,815 [DEBUG] fortress_director.orchestrator.orchestrator: Final metrics snapshot: {'order': 50, 'morale': 50, 'resources': 40, 'knowledge': 45, 'corruption': 10, 'glitch': 13, 'risk_applied_total': 0, 'major_flag_set': False, 'major_events_triggered': 0, 'major_event_last_turn': None}
2025-10-24 14:37:20,815 [DEBUG] fortress_director.agents.judge_agent: Evaluating win/loss (turn=1/10) with metrics={'order': 50, 'morale': 50, 'resources': 40, 'knowledge': 45, 'corruption': 10, 'glitch': 13, 'risk_applied_total': 0, 'major_flag_set': False, 'major_events_triggered': 0, 'major_event_last_turn': None}
2025-10-24 14:37:20,818 [INFO] fortress_director.agents.judge_agent: Win/loss evaluation result: {'status': 'ongoing', 'reason': 'thresholds_not_met'}
2025-10-24 14:37:20,818 [INFO] fortress_director.orchestrator.orchestrator: Win/loss status after turn: {'status': 'ongoing', 'reason': 'thresholds_not_met'}
2025-10-24 14:37:20,818 [INFO] fortress_director.orchestrator.orchestrator: Turn result built.
2025-10-24 14:37:20,818 [DEBUG] fortress_director.orchestrator.orchestrator: Turn result before validation: {"WORLD_CONTEXT": "Turn 0 | Day 1 | Time dawn\nLocation: entrance\nPlayer: The Shieldbearer — A weary defender holding the western wall.\nInventory: oil lamp, patched shield\nWorld constraint: {\"atmosphere\": \"low clouds hug the battlements\", \"sensory_details\": \"Drums thud beyond the walls while the wind carries grit.\"}\nRecent events: none\nRecent motifs: none\nRecent major events: none\nRelationship summary: Rhea trusts the player; Boris weighs every trade.\nCharacter summary: Rhea is loyal but impulsive; Boris is cautious and calculating.\nMetrics: {\"order\": 50, \"morale\": 50, ...
2025-10-24 14:37:20,818 [INFO] fortress_director.orchestrator.orchestrator: Turn output validated successfully.
2025-10-24 14:37:20,818 [INFO] fortress_director.orchestrator.orchestrator: Turn completed successfully.
