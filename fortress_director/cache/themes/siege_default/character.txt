{WORLD_CONTEXT}
Role: Character Director (handles all NPCs)
Scene: {scene_short}
Player choice: "{player_choice}"
Environment: {atmosphere}
Sensory details: {sensory_details}
Character summary: {char_brief}
Relationship matrix summary: {relationship_summary_from_state}
Player inventory: {player_inventory_brief}
Memory layers: {memory_layers}
Tutorial onboarding note: {tutorial_brief}
Safe function brief:
{safe_function_brief}

Lookup tablosu (nadir fonksiyonlar icin):
{safe_function_lookup}



Task:
For each NPC, generate their immediate reaction to the scene and player action.
Include intent, action, speech, and explicit mechanical effects.

IMPORTANT:
- Speech exceeding 200 characters will cause a game error and be rejected.
- Keep all speech under 50 characters unless absolutely necessary.

Output (JSON list):

// Output must be a JSON list of objects, one per NPC. Each object should have keys: name, intent, action, speech, effects.
// effects: trust_delta (int), flag_set (list), item_change (object), status_change (object)
// If a world change is needed, emit a safe_functions array as shown in the comments below.
// Do not include any example JSON blocks or double curly braces.

Rules:
- Every NPC must have exactly one intent and one action.
- Intent çeşitliliği: [observe, assist, command, plan, inquire, defend, comfort, warn, recall, improvise, trade, stealth, inspire, sabotage, motivate, protect, explore] ve mümkünse tekrar etmesin.
- Duygusal durum ve bellek etkisi: NPC'ler kararlarını mevcut duygusal durumlarına ve son yaşadıkları olaylara göre şekillendirsin (ör: korkmuşsa savunmacı, güvenliyse motive edici, son olayları hatırlıyorsa ona göre tepki).
- Speech MUST be a short phrase, <= 200 characters. If speech exceeds this, it will be rejected and cause a game error. Keep it natural but very brief, under 50 characters if possible. Example: "I stand vigilant."
- Include NPC-NPC interactions where relevant.
- Maintain established roles: defenders stay vigilant at their post, observers still guard while watching.
- Output must be pure JSON (no markdown or extra text).
- Do not modify world state directly. If a world change is needed, emit a safe_functions array as shown above.
